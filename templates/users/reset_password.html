{% extends "base.html" %}

{% block title %}
GameWear - Set New Password
{% endblock %}

{% block content %}

<div class="w-full max-w-md p-8 sm:p-10 bg-neutral-900 rounded-xl shadow-2xl border border-neutral-800">

    <header class="text-center mb-10">
        <h1 class="text-3xl font-extrabold tracking-tight text-white">
            <span class="text-neutral-500">Game</span>Wear
        </h1>
        <p class="mt-2 text-neutral-400">Set your new password</p>
    </header>

    {% if validlink %}
        <!-- Success messages/errors -->
        {% if messages %}
            {% for message in messages %}
                <div class="mb-4 rounded-lg px-4 py-3 text-sm font-medium
                    {% if message.tags == 'success' %}
                        bg-green-500/10 text-green-400 border border-green-500/30
                    {% elif message.tags == 'error' %}
                        bg-red-500/10 text-red-400 border border-red-500/30
                    {% else %}
                        bg-blue-500/10 text-blue-400 border border-blue-500/30
                    {% endif %}
                ">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <form method="post" class="space-y-6  action="{%  url 'users:reset_password' %}"" >
            {% csrf_token %}

            <!-- New Password Field -->
            <div>
                <label for="id_new_password1" class="block text-sm font-medium text-neutral-300 mb-2">
                    New Password
                </label>
                <input type="password" name="password1" id="id_new_password1" required autocomplete="new-password"
                    class="w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg focus:ring-2 focus:ring-white text-white placeholder-neutral-500 transition duration-200 outline-none"
                    placeholder="••••••••">
                
                {% if form.new_password1.errors %}
                    <div class="mt-2 text-xs text-red-400 space-y-1">
                        {{ form.new_password1.errors }}
                    </div>
                {% endif %}
            </div>

            <!-- Confirm New Password Field -->
            <div>
                <label for="id_new_password2" class="block text-sm font-medium text-neutral-300 mb-2">
                    Confirm New Password
                </label>
                <input type="password" name="password2" id="id_new_password2" required autocomplete="new-password"
                    class="w-full px-4 py-3 bg-neutral-800 border border-neutral-700 rounded-lg focus:ring-2 focus:ring-white text-white placeholder-neutral-500 transition duration-200 outline-none"
                    placeholder="••••••••">
                
                {% if form.new_password2.errors %}
                    <div class="mt-2 text-xs text-red-400 space-y-1">
                        {{ form.new_password2.errors }}
                    </div>
                {% endif %}
            </div>

            <button type="submit"
                class="w-full py-3 rounded-lg font-bold text-neutral-900 bg-white hover:bg-neutral-200 transition duration-200">
                Reset Password
            </button>
        </form>

    {% else %}
        <!-- Invalid Link State -->
        <div class="text-center py-6">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-500/10 border border-red-500/30 mb-4">
                <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 17c-.77 1.333.192 3 1.732 3z"/>
                </svg>
            </div>
            <h2 class="text-xl font-bold text-white mb-2">Invalid Link</h2>
            <p class="text-neutral-400 text-sm mb-6">
                The password reset link was invalid, possibly because it has already been used. Please request a new password reset.
            </p>
            <a href="#" 
                class="inline-block w-full py-3 rounded-lg font-bold text-neutral-900 bg-white hover:bg-neutral-200 transition">
                Request New Link
            </a>
        </div>
    {% endif %}

    <p class="mt-8 text-center text-sm text-neutral-400">
        Nevermind, I remembered! 
        <a href="{% url 'users:login' %}" class="text-white font-semibold hover:text-neutral-300 transition">
            Back to login
        </a>
    </p>

</div>

{% endblock %}